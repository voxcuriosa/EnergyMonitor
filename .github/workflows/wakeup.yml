name: Wake Up App

on:
  schedule:
    # Run every 4 hours to keep the app warm
    - cron: '0 0,4,8,12,16,20 * * *'
  workflow_dispatch: # Allows manual triggering from Actions tab

jobs:
  wakeup:
    runs-on: ubuntu-latest
    steps:
      - name: Small Random Delay
        run: |
          # Sleep for a random time between 1 and 300 seconds (5 minutes)
          # This helps avoid multiple apps hitting the service at the exact same second
          SLEEP_TIME=$((1 + RANDOM % 300))
          echo "Sleeping for $SLEEP_TIME seconds..."
          sleep $SLEEP_TIME

      - name: Wake up Streamlit App
        run: |
          # Use -L to follow redirects and -S to show errors
          # We use a GET request to trigger the full app load
          curl -L -S -f https://cbvenergy.streamlit.app/ || echo "App might be booting..."
          echo "Ping sent to Streamlit App"
